# VPNインテグレーションの概要

Liferay DXP Cloudでは、ポートフォワーディングと冗長トンネルをサポートしたクライアントからサイトへのVPN接続を提供しています。 この機能は、通常、DXP Cloud上のサブスクライバーの本番環境を内部ネットワークに接続するために使用されます。 セキュリティと信頼性のために、これらのVPN接続は環境ごと（本番環境、ステージング、または開発）に分離されています。

![トポロジー1 - DXP Cloud VPNクライアントからサイトへのトポロジーについて](./vpn-integration-overview/images/01.png)

加入者は、DXP Cloudサービス間の接続を対応するVPNサーバーのIPアドレスにマッピングすることにより、冗長VPNトンネルを使用できます。 冗長性はさまざまなアベイラビリティーゾーンに配置され、回復力を提供します。 クライアントからサイトへのアプローチには、企業ネットワークで実行されているサービスへの接続が含まれます。 このモデルは、コンテナ化されたアーキテクチャーと、提供されるKubernetesネットワークレイヤーに推奨されます。

詳細は、 [VPNサーバーの制限](../../reference/dxp-cloud-limitations.md#vpn-servers) のセクションを参照してください。

## 設定

クライアントからサイトへのVPN機能は、次のプロトコルをサポートしています。

  - IPsec (IKEv2)
  - OpenVPN

サブスクライバーは、プロトコル（IPSecまたはOpenVPN）のいずれかを選択して、目的の環境のDXP Cloudコンソール設定ページから接続を実行できます。 コンソールUIでは、接続に任意の数の転送ポートを設定できます。 詳しくは [Connecting a VPN Server to DXP Cloud](./connecting-a-vpn-server-to-dxp-cloud.md) をご覧ください。

## DXP CloudとIPSec VPNサーバーの接続

この使用例では、DXP Cloud内で実行されているDXPポータルインスタンスがあり、内部ネットワーク内で実行されているHTTPサービスにアクセスする必要があると想定します。

![トポロジ2-顧客の企業ネットワーク内のHTTPサービスにアクセスするポータルインスタンス](./vpn-integration-overview/images/02.png)

次のことに注意してください。

  - お客様の内部ネットワーク内にある `192.168.100.30:8080` 上のHello Worldサービスは、DXPポータルサービスから `vpn:33000`というサーバーアドレスを介してアクセスできます。
  - クライアントからサーバーへの接続は、 `18.188.145.101:500`実行されている顧客のVPNサーバーを介して行われます。
  - ポート転送ルールは、ローカルポート **33000** を公開し、 `192.168.100.30:8080`上で実行されているアプリケーションにマップします。

接続とポート転送ルールが設定　された後、Hello Worldサービスへのリクエストは、任意のDXP Cloudサービスから行うことができます。

``` bash
curl vpn:33000

<body><h1>Hello world!</h1></body></html>
```

### 共有クラスターのDXP CloudIP範囲

DXP Cloudは、VPNサーバーにマッピングできる幅広い利用可能なIPアドレスを使用します。 デフォルトでは、DXP Cloudサービスのすべての発信外部IPアドレスは固定されていません。

安定した発信外部IPアドレスを取得する最良の方法は、DXP Cloudプライベートクラスター機能を使用することです。

### プライベートクラスタのDXP CloudIP範囲

Liferay DXP Cloudは、各加入者のサービスを独自の専用クラスターに分離するオプションのプライベートクラスターを提供します。 各クラスターは、サブスクライバーのクラスターからのすべての送信インターネットトラフィック専用のゲートウェイで設定され、静的外部IPが割り当てられます。

## 次のステップ

  - [Client-to-Site VPNの設定例](./configuring-a-vpn-server.md)
